# TSLA & TSLL Portfolio Adjustment Program

## Overview
이 프로그램은 TSLA와 TSLL의 주식 데이터를 분석하여 다양한 기술적 지표를 기반으로 포트폴리오 비중을 조정합니다. 사용되는 지표에는 Fear & Greed Index, RSI, Bollinger Bands, 거래량 변화 등이 포함되며, 이를 통해 매수/매도 신호를 제공하고 TSLA와 TSLL의 최적 비중을 추천합니다.

## Features
- CNN에서 실시간 Fear & Greed Index를 수집
- `yfinance`를 통해 TSLA와 TSLL의 주식 데이터 수집
- RSI, SMA, Bollinger Bands, MACD 등 기술적 지표 계산
- 미리 정의된 조건에 따라 포트폴리오 비중 조정
- 시장 지표, 추천 비중, 조정 이유 출력

## Installation
프로그램을 실행하려면 아래 Python 라이브러리를 설치해야 합니다.

```bash
pip install yfinance pandas requests scipy tabulate
```

## Usage
저장소를 클론합니다.

```bash
git clone https://github.com/pjhwa/tsla.git
```

프로젝트 디렉토리로 이동합니다.

```bash
cd tsla
```

프로그램을 실행합니다.

```bash
python TSLA_Portfolio.py
```

프로그램은 시장 지표, 추천 포트폴리오 비중, 조정 이유를 출력합니다.

## 지표 계산

### RSI
14일 기준 상대강도지수를 계산합니다.
### SMA
50일 및 200일 단순 이동 평균을 계산합니다.
### Bollinger Bands
20일 기준 상단/하단 밴드를 계산합니다.
### MACD
12일, 26일, 9일 기준으로 계산합니다.
### RSI Trend
최근 10일 데이터를 통해 상승/하락/안정 추세를 판단합니다.

## 매수/매도 신호 판단

### 매수 신호
매수 신호는 아래 조건 중 하나 이상이 충족될 때 발생합니다.
- Fear & Greed Index ≤ 50: 시장이 공포 상태에 있어 매수 기회가 될 수 있음을 나타냅니다.
- 일간 RSI < 30: TSLA가 일간 기준으로 과매도 상태임을 나타냅니다.
- 주간 RSI < 35: 주간 기준으로 과매도 가능성을 시사합니다.
- 거래량 변화 > 15%: 거래량이 크게 증가하여 가격 변동이 예상됨을 나타냅니다.

### 매도 신호
매도 신호는 아래 조건 중 하나 이상이 충족될 때 발생합니다:
- Fear & Greed Index ≥ 70: 시장이 탐욕 상태에 있어 매도 타이밍일 가능성을 나타냅니다.
- 일간 RSI > 75: TSLA가 일간 기준으로 과매수 상태임을 나타냅니다.
- 주간 RSI > 65: 주간 기준으로 과매수 가능성을 시사합니다.
- 거래량 변화 < -15%: 거래량이 크게 감소하여 모멘텀이 약화되었음을 나타냅니다.

## 포트폴리오 조정
포트폴리오는 생성된 매수 및 매도 신호에 따라 TSLL의 비중을 동적으로 조정합니다. 조정 방식은 다음과 같습니다:

### 비중 조정 로직
- 매수 신호: TSLL의 포트폴리오 비중을 증가시킵니다.
- 조정 공식: 비중 증가 = w_buy * 매수 신호 수 * 0.1
- 예: 매수 신호가 2개일 경우, 비중 증가 = 1.0 * 2 * 0.1 = 0.2 (20% 증가).
###
- 매도 신호: TSLL의 포트폴리오 비중을 감소시킵니다.
- 조정 공식: 비중 감소 = w_sell * 매도 신호 수 * 0.1
- 예: 매도 신호가 1개일 경우, 비중 감소 = 2.0 * 1 * 0.1 = 0.2 (20% 감소).
###
- 최종 비중 계산: 목표 TSLL 비중은 다음과 같이 계산됩니다.
- 목표 비중 = 현재 비중 + 비중 증가 - 비중 감소
- 비중은 0%에서 100% 사이로 제한됩니다.

### 포트폴리오 조정 예시
#### 시나리오 #1
- 현재 TSLL 비중: 30%
- 매수 신호: 2개 (예: 일간 RSI < 30, 거래량 변화 > 15%)
- 매도 신호: 1개 (예: Fear & Greed Index ≥ 70)
###
조정 계산:
- 증가: 1.0 * 2 * 0.1 = 0.2 (20%)
- 감소: 2.0 * 1 * 0.1 = 0.2 (20%)
###
목표 비중: 30% + 20% - 20% = 30% (변화 없음)
###
#### 시나리오 #2
- 현재 TSLL 비중: 50%
- 매수 신호: 3개 (예: Fear & Greed ≤ 50, 일간 RSI < 30, 주간 RSI < 35)
- 매도 신호: 0개
###
조정 계산:
- 증가: 1.0 * 3 * 0.1 = 0.3 (30%)
###
목표 비중: 50% + 30% = 80% (TSLL 비중 증가)

## Example Output
프로그램 실행 시 다음과 같은 출력이 표시됩니다.

```bash
$ ./TSLA_Portfolio.py
데이터 로드 중...

### Market Indicators (as of 2025-03-17)
╒══════════════════════╤═════════╤═══════════════╕
│ Indicator            │ Value   │ Trend/Notes   │
╞══════════════════════╪═════════╪═══════════════╡
│ Fear & Greed Index   │ 22.54   │ -             │
├──────────────────────┼─────────┼───────────────┤
│ Daily RSI            │ 31.11   │ Increasing    │
├──────────────────────┼─────────┼───────────────┤
│ Weekly RSI           │ 14.97   │ -             │
├──────────────────────┼─────────┼───────────────┤
│ TSLA Close           │ $238.01 │ -             │
├──────────────────────┼─────────┼───────────────┤
│ SMA50                │ $348.30 │ -             │
├──────────────────────┼─────────┼───────────────┤
│ SMA200               │ $282.99 │ -             │
├──────────────────────┼─────────┼───────────────┤
│ Upper Bollinger Band │ $371.22 │ -             │
├──────────────────────┼─────────┼───────────────┤
│ Lower Bollinger Band │ $198.51 │ -             │
├──────────────────────┼─────────┼───────────────┤
│ Volume Change        │ 11.11%  │ -             │
╘══════════════════════╧═════════╧═══════════════╛

### Current Stock Prices
- **TSLA Close**: $238.01
- **TSLL Close**: $8.34

### Recommended Portfolio Weights
- **TSLA Weight**: 90%
- **TSLL Weight**: 10%

### Portfolio Adjustment
 - Buy TSLL: $10000.00

### Adjustment Reasons
- Buy Signal: Fear & Greed Index ≤ 50
```

## 백테스트
과거 데이터를 기준으로 각 지표에 대한 최적의 파라미터를 찾기 위한 백테스트를 Portfolio_backtest.py로 수행할 수 있습니다. 
도출된 최적의 파라미터는 optimal_params.json 파일로 저장되고, TSLA_Portfolio.py 실행시 읽어들입니다.

## Disclaimer
이 프로그램은 교육 목적으로만 제공되며, 투자 조언으로 간주되지 않습니다. 투자 결정을 내리기 전에 반드시 금융 전문가와 상담하시기 바랍니다.
